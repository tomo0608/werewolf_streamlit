# 人狼ゲーム

これはPythonとStreamlitで実装された人狼ゲームのWebアプリです。

## 概要

プレイヤーは村人陣営と人狼陣営（および第三陣営）に分かれ、それぞれの勝利条件を目指します。
ゲームは、プレイヤー数、プレイヤー名、各役職の人数を設定した後、夜と昼のフェーズを繰り返して進行します。

## 環境構築

### 必要条件
- Python 3.8以上
- pyenv（Pythonバージョン管理用）

### セットアップ手順

1. リポジトリをクローン:
   ```bash
   git clone [リポジトリURL]
   cd werewolf_streamlit
   ```

2. pyenvで適切なPythonバージョンを設定:
   ```bash
   pyenv install 3.10.0  # または他の最新バージョン
   pyenv local 3.10.0
   ```

3. 仮想環境を作成して有効化:
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Linuxまたはmacの場合
   # または
   .venv\Scripts\activate     # Windowsの場合
   ```

4. 依存パッケージをインストール:
   ```bash
   pip install -r requirements.txt
   ```

## 実行方法

Streamlitアプリを以下のコマンドで起動します：

```bash
streamlit run app.py
```

### スマホからのアクセス

ngrokを使用してスマホからアクセスできます：

1. Streamlitアプリを起動：
   ```bash
   streamlit run app.py
   ```

2. 別のターミナルでngrokを起動：
   ```bash
   ngrok http 8501
   ```

3. 表示されるURLをスマホのブラウザで開きます。

**注意**: スマホからプレイした場合、結果のJSONファイルはローカルのPC上にのみ保存されます。スマホ側には保存されません。

## 設定

`config/settings.py` ファイルで、ゲームのデフォルト設定を行うことができます。

- `DEFAULT_PLAYER_COUNT`: デフォルトのプレイヤー人数
- `DEFAULT_ROLE_COUNTS`: デフォルトの役職構成（合計人数が `DEFAULT_PLAYER_COUNT` と一致する場合に適用）

これらの設定が存在しない、または条件を満たさない場合は、ゲーム開始時にWebインターフェースから入力を求められます。

## テスト

`tests` ディレクトリにユニットテストが含まれています。
プロジェクトのルートディレクトリで以下のコマンドを実行してテストを実行できます。

```bash
python3 -m pytest
```

## ゲームの流れ

1.  **初期設定**: プレイヤー数、プレイヤー名、役職の人数を設定します。（`config/settings.py` のデフォルト値を使用するか、Webインターフェースで入力します）
2.  **役職割り当て**: 各プレイヤーにランダムに役職が割り当てられます。
3.  **ゲーム開始**: 設定確認後、ゲームを開始します。
4.  **夜フェーズ**: 各役職がそれぞれの能力を行使します（人狼の襲撃、占い師の占いなど）。
5.  **昼フェーズ**: 夜の間の出来事（襲撃結果など）がアナウンスされ、生存者による議論と投票が行われます。投票により最も票を集めたプレイヤーが処刑されます。
6.  **勝利判定**: 各フェーズの終わりに勝利条件が満たされたかチェックされます。
7.  **繰り返し**: 勝利条件が満たされるまで、夜と昼のフェーズを繰り返します。
8.  **ゲーム終了**: 勝利陣営が決定し、全プレイヤーの役職が開示されます。

## 結果の保存

ゲーム終了後、各プレイヤーの役職、勝敗、獲得ポイントなどの結果が `result/` ディレクトリに `{実行日時}.json` というファイル名で保存されます。
**注意**: Streamlit版でスマホからプレイした場合でも、結果データはアプリを実行しているPC上にのみ保存されます。 